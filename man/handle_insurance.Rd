% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/insurance.R
\name{handle_insurance}
\alias{handle_insurance}
\title{Handle insurance offers and dealer blackjack check}
\usage{
handle_insurance(dealer_hand, players, input_fun = readline, ai_prob = 0.5)
}
\arguments{
\item{dealer_hand}{A \code{blackjack_hand} object for the dealer.}

\item{players}{Named list of players (each with is_computer, coins, bets, etc.).}

\item{input_fun}{Function for user input (default: readline).}

\item{ai_prob}{Numeric, probability of AI buying insurance (default 0.5).}
}
\value{
A list with:
  \describe{
    \item{dealer_blackjack}{Logical: whether the dealer has Blackjack.}
    \item{players}{Updated player list after insurance resolution.}
  }
}
\description{
Offers insurance to all players if the dealer's upcard is an Ace,
and settles insurance bets depending on whether the dealer has a Blackjack.
Also reveals the dealer's hand if the upcard is a 10-value card and the dealer has Blackjack.
}
\examples{
\dontrun{
# Example 1: Dealer shows Ace, both human and computer players
players <- list(
  Alice = list(is_computer = FALSE, coins = 1000, bets = 100),
  Bot = list(is_computer = TRUE, coins = 1000, bets = 100)
)
dealer_hand <- new_blackjack_hand(c("A♠", "10♦"))  # Dealer has Blackjack
# Both players will be offered insurance. Try typing "yes" or "no" when prompted.
res <- handle_insurance(dealer_hand, players)
print(res)

# Example 2: Dealer shows Ace, no Blackjack
dealer_hand <- new_blackjack_hand(c("A♠", "5♦"))
# Insurance will be offered, but dealer does not have Blackjack.
res <- handle_insurance(dealer_hand, players)
print(res)

# Example 3: Dealer does NOT show Ace, insurance is not offered
dealer_hand <- new_blackjack_hand(c("9♣", "A♦"))
# No insurance prompt; function just returns dealer_blackjack and updated players
res <- handle_insurance(dealer_hand, players)
print(res)

# Example 4: Use a custom AI insurance probability
res <- handle_insurance(dealer_hand, players, ai_prob = 0.9)

# The output list has two elements:
# $dealer_blackjack - TRUE if dealer has blackjack, FALSE otherwise
# $players          - player info after insurance (coins may change)
}
}
